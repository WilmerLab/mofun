
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.8">
    
    
      
        <title>Atoms - MOFUN</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.92558b1b.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mofun.atoms" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="MOFUN" class="md-header__button md-logo" aria-label="MOFUN" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MOFUN
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Atoms
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="MOFUN" class="md-nav__button md-logo" aria-label="MOFUN" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    MOFUN
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        MOFUN
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      <label class="md-nav__link" for="__nav_2">
        Reference
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Atoms
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Atoms
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mofun.atoms" class="md-nav__link">
    mofun.atoms
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mofun.atoms.Atoms" class="md-nav__link">
    Atoms
  </a>
  
    <nav class="md-nav" aria-label="Atoms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mofun.atoms.Atoms.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mofun.atoms.Atoms.extend" class="md-nav__link">
    extend()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mofun.atoms.Atoms.from_ase_atoms" class="md-nav__link">
    from_ase_atoms()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mofun.atoms.Atoms.load" class="md-nav__link">
    load()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mofun.atoms.Atoms.load_cif" class="md-nav__link">
    load_cif()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mofun.atoms.Atoms.load_cml" class="md-nav__link">
    load_cml()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mofun.atoms.Atoms.load_lmpdat" class="md-nav__link">
    load_lmpdat()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mofun.atoms.Atoms.replicate" class="md-nav__link">
    replicate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mofun.atoms.Atoms.save" class="md-nav__link">
    save()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mofun.atoms.Atoms.save_lmpdat" class="md-nav__link">
    save_lmpdat()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mofun.atoms.Atoms.save_mol" class="md-nav__link">
    save_mol()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mofun.atoms.Atoms.to_ase" class="md-nav__link">
    to_ase()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mofun.atoms.find_unchanged_atom_pairs" class="md-nav__link">
    find_unchanged_atom_pairs()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../mofun/" class="md-nav__link">
        Mofun
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mofun.atoms" class="md-nav__link">
    mofun.atoms
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mofun.atoms.Atoms" class="md-nav__link">
    Atoms
  </a>
  
    <nav class="md-nav" aria-label="Atoms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mofun.atoms.Atoms.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mofun.atoms.Atoms.extend" class="md-nav__link">
    extend()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mofun.atoms.Atoms.from_ase_atoms" class="md-nav__link">
    from_ase_atoms()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mofun.atoms.Atoms.load" class="md-nav__link">
    load()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mofun.atoms.Atoms.load_cif" class="md-nav__link">
    load_cif()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mofun.atoms.Atoms.load_cml" class="md-nav__link">
    load_cml()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mofun.atoms.Atoms.load_lmpdat" class="md-nav__link">
    load_lmpdat()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mofun.atoms.Atoms.replicate" class="md-nav__link">
    replicate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mofun.atoms.Atoms.save" class="md-nav__link">
    save()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mofun.atoms.Atoms.save_lmpdat" class="md-nav__link">
    save_lmpdat()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mofun.atoms.Atoms.save_mol" class="md-nav__link">
    save_mol()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mofun.atoms.Atoms.to_ase" class="md-nav__link">
    to_ase()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mofun.atoms.find_unchanged_atom_pairs" class="md-nav__link">
    find_unchanged_atom_pairs()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Atoms</h1>
                
                <div class="doc doc-object doc-module">

<a id="mofun.atoms"></a>
    <div class="doc doc-contents first">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h2 id="mofun.atoms.Atoms" class="doc doc-heading">
        <code>Atoms</code>



</h2>

    <div class="doc doc-contents ">

      <p>An Atoms object is a container for all the information required to keep track of a structure and
the structure's force field.</p>
<p>See the documentation on <code>__init__</code> or <code>load</code> to see how to create an Atoms object.</p>
<p>An Atoms object is made up primarily of numpy arrays and a couple normal lists.</p>
<p>Some arrays are per-atom (one entry per atom): <code>atom_types</code>, <code>positions</code>, <code>charges</code>, and
<code>groups</code>.</p>
<p>Some arrays are per-atom-type (one entry per atom type): <code>atom_type_masses</code>, <code>atom_type_elements</code>, and
<code>atom_type_labels</code>.</p>
<p>Some arrays are per-bond (one entry per bond): <code>bonds</code>, and <code>bond_types</code>.</p>
<p>Some arrays are per-angle (one entry per angle): <code>angles</code>, and <code>angle_types</code>.</p>
<p>Some arrays are per-dihedral (one entry per dihedral): <code>dihedrals</code>, and <code>dihedral_types</code>.</p>
<p>Some arrays are per-improper (one entry per improper): <code>impropers</code>, and <code>improper_types</code>.</p>
<p>Atoms also stores information on the coefficients needed to define each force field term:
<code>pair_coeffs</code>, <code>bond_type_coeffs</code>, <code>angle_type_coeffs</code>, <code>dihedral_type_coeffs</code>, and
<code>improper_type_coeffs</code>. The *_coeffs variables are lists of strings, where the item index
corresponds to the *_type, and the string is the full LAMMPS coeffs definition string. we do
not interpret any of the LAMMPS coefficient specifics, we just store it in its original form,
i.e. this Angle Coeffs section:</p>
<pre><code>Angle Coeffs

1 cosine/periodic  72.500283  -1  1   # C_R O_1 H_
2 cosine/periodic  277.164705  -1  3   # C_R C_R O_1
</code></pre>
<p>would be interpreted like this:</p>
<pre><code>angle_type_coeffs= [&quot;cosine/periodic  72.500283  -1  1   # C_R O_1 H_&quot;,
                    &quot;cosine/periodic  277.164705  -1  3   # C_R C_R O_1&quot;]
</code></pre>




  <div class="doc doc-children">


















  <div class="doc doc-object doc-method">



<h3 id="mofun.atoms.Atoms.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atom_types</span><span class="o">=</span><span class="p">[],</span> <span class="n">positions</span><span class="o">=</span><span class="p">[],</span> <span class="n">charges</span><span class="o">=</span><span class="p">[],</span> <span class="n">groups</span><span class="o">=</span><span class="p">[],</span> <span class="n">elements</span><span class="o">=</span><span class="p">[],</span> <span class="n">atom_type_masses</span><span class="o">=</span><span class="p">[],</span> <span class="n">atom_type_elements</span><span class="o">=</span><span class="p">[],</span> <span class="n">atom_type_labels</span><span class="o">=</span><span class="p">[],</span> <span class="n">bonds</span><span class="o">=</span><span class="p">[],</span> <span class="n">bond_types</span><span class="o">=</span><span class="p">[],</span> <span class="n">angles</span><span class="o">=</span><span class="p">[],</span> <span class="n">angle_types</span><span class="o">=</span><span class="p">[],</span> <span class="n">dihedrals</span><span class="o">=</span><span class="p">[],</span> <span class="n">dihedral_types</span><span class="o">=</span><span class="p">[],</span> <span class="n">impropers</span><span class="o">=</span><span class="p">[],</span> <span class="n">improper_types</span><span class="o">=</span><span class="p">[],</span> <span class="n">pair_coeffs</span><span class="o">=</span><span class="p">[],</span> <span class="n">bond_type_coeffs</span><span class="o">=</span><span class="p">[],</span> <span class="n">angle_type_coeffs</span><span class="o">=</span><span class="p">[],</span> <span class="n">dihedral_type_coeffs</span><span class="o">=</span><span class="p">[],</span> <span class="n">improper_type_coeffs</span><span class="o">=</span><span class="p">[],</span> <span class="n">cell</span><span class="o">=</span><span class="p">[])</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Create an Atoms object.</p>
<p>An Atoms object can be created without any atoms using <code>Atoms()</code>. For creating more
interesting Atoms objects, there are a few rules to keep in mind. The parameters
<code>atom_types</code>, <code>positions</code>, <code>charges</code>, and <code>groups</code>  are all lists that should have a
size equal to the number of atoms in the system. <code>positions</code> is mandatory; <code>charges</code>, and
<code>groups</code> are optional (both default to 0 for each atom) and there are two ways to
specify atom types: 1) specify the atom_types and atom_type_elements explicitly, which is
how the <code>load_lmpdat</code> method loads Atoms objects from a LAMMPS data file, or 2) specify
per-atom elements and and have MOFUN auto-number the atom types for you, which is more
convenient when specifying small molecules in code or when loading from other file formats
such as CML or CIF which may store element information but not type information.</p>
<p>When explicitly setting the types, you must pass <code>atom_types</code> and <code>atom_type_elements</code>.
<code>atom_types</code> is a list of int type ids &gt;= 0, one for each atom in the system.
<code>atom_type_elements</code> is a list of element names (e.g. "C", "N", "Zr") per <em>atom type</em>. For
example, if your system is propane, your atom_types list could be [0, 1, 1, 1] and your
atom_type_elements list would then be ["C", "H"].</p>
<p>To specify per-atom elements, you must pass <code>elements</code> with either a list of elements, such
as <code>Atoms(elements=["C", "C"], ...)</code> or with a string <code>Atoms(elements="CC", ...)</code>. If you
use the <code>elements</code> parameter, then type ids are automatically generated.</p>
<p>Passing <code>atom_type_masses</code> is optional, and masses will be inferred from the elements if
missing. If you are using atom types with masses that do not correspond to periodic table
elements, then you will need to specify the masses explicitly.</p>
<p>Passing force field term information for <code>bonds</code>, <code>angles</code>, <code>dihedrals</code>, and <code>impropers</code> is optional, as well
as passing force field coefficients for LAMMPS with <code>pair_coeffs</code>, <code>bond_type_coeffs</code>,
<code>angle_type_coeffs</code>, <code>dihedral_type_coeffs</code>, and <code>improper_type_coeffs</code>.</p>

<p><strong>Examples:</strong></p>
    
      <pre><code> a = Atoms() # create an empty Atoms object with no atoms
 a = Atoms(atom_types=[0], positions=[[0,0,0]]) # create one atom of type 0
 a = Atoms(elements=[&quot;C&quot;], positions=[[0,0,0]]) # create one Carbon
 a = Atoms(elements=[&quot;C&quot;, &quot;C&quot;], positions=[[0,0,0], [1,0,0]]) # create two Carbons
 a = Atoms(elements=&quot;CC&quot;, positions=[[0,0,0], [1,0,0]]) # create two Carbons using shorthand element notation
</code></pre>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>atom_types</code></td>
        <td><code>List[int]</code></td>
        <td><p>list of integer type ids, one per atom.</p></td>
        <td><code>[]</code></td>
      </tr>
      <tr>
        <td><code>positions</code></td>
        <td><code>List[Tuple[float, float, float]]</code></td>
        <td><p>list of tuple atom x,y,z coordinates, one per atom.</p></td>
        <td><code>[]</code></td>
      </tr>
      <tr>
        <td><code>charges</code></td>
        <td><code>List[float]</code></td>
        <td><p>list of charges, one per atom. Defaults to 0 for each atom if not passed.</p></td>
        <td><code>[]</code></td>
      </tr>
      <tr>
        <td><code>groups</code></td>
        <td><code>List[int]</code></td>
        <td><p>list of integer groups, one per atom. For LAMMPS this gets mapped to a "molecule id". Defaults to 0 for each atom if not passed.</p></td>
        <td><code>[]</code></td>
      </tr>
      <tr>
        <td><code>elements</code></td>
        <td><code>List[str], str</code></td>
        <td><p>either a list of elements, (e.g. ["C", "H", "H", "H"]) or an element string (e.g. "CHHH")</p></td>
        <td><code>[]</code></td>
      </tr>
      <tr>
        <td><code>atom_type_masses</code></td>
        <td><code>List[float]</code></td>
        <td><p>list of atom type masses, one per atom type. If masses are not passed, they will be inferred from the <code>atom_type_elements</code>.</p></td>
        <td><code>[]</code></td>
      </tr>
      <tr>
        <td><code>atom_type_elements</code></td>
        <td><code>List[str]</code></td>
        <td><p>list of atom type elements, one per atom type.</p></td>
        <td><code>[]</code></td>
      </tr>
      <tr>
        <td><code>atom_type_labels</code></td>
        <td><code>List[str]</code></td>
        <td><p>list of atom type labels, one per atom type. Used in LAMMPS data file line comments as type labels.</p></td>
        <td><code>[]</code></td>
      </tr>
      <tr>
        <td><code>bonds</code></td>
        <td><code>List[Tuple[int, int]]</code></td>
        <td><p>list of bond tuples where each tuple defines a pair of atoms that are bonded. Each value in the tuple is an index of an atom in the atom_* lists.</p></td>
        <td><code>[]</code></td>
      </tr>
      <tr>
        <td><code>bond_types</code></td>
        <td><code>List[int]</code></td>
        <td><p>list of bond type id ints for each bond defined in <code>bonds</code>.</p></td>
        <td><code>[]</code></td>
      </tr>
      <tr>
        <td><code>angles</code></td>
        <td><code>List[Tuple[int, int, int]]</code></td>
        <td><p>list of angle tuples where each tuple defines a triplet of atoms making up the angle. Each value in the tuple is an index of an atom in the atom_* lists.</p></td>
        <td><code>[]</code></td>
      </tr>
      <tr>
        <td><code>angle_types</code></td>
        <td><code>List[int]</code></td>
        <td><p>list of angle type id ints for each angle defined in <code>angles</code>.</p></td>
        <td><code>[]</code></td>
      </tr>
      <tr>
        <td><code>dihedrals</code></td>
        <td><code>List[Tuple[int, int, int, int]]</code></td>
        <td><p>list of dihedral tuples where each dihedral defines a quartet of atoms making up the dihedral. Each value in the tuple is an index of an atom in the atom_* lists.</p></td>
        <td><code>[]</code></td>
      </tr>
      <tr>
        <td><code>dihedral_types</code></td>
        <td><code>List[int]</code></td>
        <td><p>list of dihedral type id ints for each dihedral defined in <code>dihedrals</code>.</p></td>
        <td><code>[]</code></td>
      </tr>
      <tr>
        <td><code>impropers</code></td>
        <td><code>List[Tuple[int, int, int, int]]</code></td>
        <td><p>list of improper tuples where each improper defines a quartet of atoms making up the improper. Each value in the tuple is an index of an atom in the atom_* lists.</p></td>
        <td><code>[]</code></td>
      </tr>
      <tr>
        <td><code>improper_types</code></td>
        <td><code>List[int]</code></td>
        <td><p>list of improper type id ints for each improper defined in <code>impropers</code>.</p></td>
        <td><code>[]</code></td>
      </tr>
      <tr>
        <td><code>pair_coeffs</code></td>
        <td><code>List[str]</code></td>
        <td><p>pair coefficients definition string (anything supported by LAMMPS in a data file but without the type id). One per atom type.</p></td>
        <td><code>[]</code></td>
      </tr>
      <tr>
        <td><code>bond_type_coeffs</code></td>
        <td><code>List[str]</code></td>
        <td><p>bond coefficients definition string (anything supported by LAMMPS in a data file but without the type id). One per bond type.</p></td>
        <td><code>[]</code></td>
      </tr>
      <tr>
        <td><code>angle_type_coeffs</code></td>
        <td><code>List[str]</code></td>
        <td><p>angle coefficients definition string (anything supported by LAMMPS in a data file but without the type id). One per angle type.</p></td>
        <td><code>[]</code></td>
      </tr>
      <tr>
        <td><code>dihedral_type_coeffs</code></td>
        <td><code>List[str]</code></td>
        <td><p>dihedral coefficients definition string (anything supported by LAMMPS in a data file but without the type id). One per dihedral type.</p></td>
        <td><code>[]</code></td>
      </tr>
      <tr>
        <td><code>improper_type_coeffs</code></td>
        <td><code>List[str]</code></td>
        <td><p>improper coefficients definition string (anything supported by LAMMPS in a data file but without the type id). One per improper type.</p></td>
        <td><code>[]</code></td>
      </tr>
      <tr>
        <td><code>cell</code></td>
        <td><code>Array(3x3</code></td>
        <td><p>3x3 array of unit cell vectors.</p></td>
        <td><code>[]</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Atoms</code></td>
      <td><p>the atoms object.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>mofun/atoms.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atom_types</span><span class="o">=</span><span class="p">[],</span> <span class="n">positions</span><span class="o">=</span><span class="p">[],</span> <span class="n">charges</span><span class="o">=</span><span class="p">[],</span> <span class="n">groups</span><span class="o">=</span><span class="p">[],</span>
                <span class="n">elements</span><span class="o">=</span><span class="p">[],</span> <span class="n">atom_type_masses</span><span class="o">=</span><span class="p">[],</span> <span class="n">atom_type_elements</span><span class="o">=</span><span class="p">[],</span> <span class="n">atom_type_labels</span><span class="o">=</span><span class="p">[],</span>
                <span class="n">bonds</span><span class="o">=</span><span class="p">[],</span> <span class="n">bond_types</span><span class="o">=</span><span class="p">[],</span> <span class="n">angles</span><span class="o">=</span><span class="p">[],</span> <span class="n">angle_types</span><span class="o">=</span><span class="p">[],</span>
                <span class="n">dihedrals</span><span class="o">=</span><span class="p">[],</span> <span class="n">dihedral_types</span><span class="o">=</span><span class="p">[],</span> <span class="n">impropers</span><span class="o">=</span><span class="p">[],</span> <span class="n">improper_types</span><span class="o">=</span><span class="p">[],</span>
                <span class="n">pair_coeffs</span><span class="o">=</span><span class="p">[],</span> <span class="n">bond_type_coeffs</span><span class="o">=</span><span class="p">[],</span> <span class="n">angle_type_coeffs</span><span class="o">=</span><span class="p">[],</span>
                <span class="n">dihedral_type_coeffs</span><span class="o">=</span><span class="p">[],</span> <span class="n">improper_type_coeffs</span><span class="o">=</span><span class="p">[],</span> <span class="n">cell</span><span class="o">=</span><span class="p">[]):</span>
    <span class="sd">&quot;&quot;&quot;Create an Atoms object.</span>

<span class="sd">    An Atoms object can be created without any atoms using `Atoms()`. For creating more</span>
<span class="sd">    interesting Atoms objects, there are a few rules to keep in mind. The parameters</span>
<span class="sd">    `atom_types`, `positions`, `charges`, and `groups`  are all lists that should have a</span>
<span class="sd">    size equal to the number of atoms in the system. `positions` is mandatory; `charges`, and</span>
<span class="sd">    `groups` are optional (both default to 0 for each atom) and there are two ways to</span>
<span class="sd">    specify atom types: 1) specify the atom_types and atom_type_elements explicitly, which is</span>
<span class="sd">    how the `load_lmpdat` method loads Atoms objects from a LAMMPS data file, or 2) specify</span>
<span class="sd">    per-atom elements and and have MOFUN auto-number the atom types for you, which is more</span>
<span class="sd">    convenient when specifying small molecules in code or when loading from other file formats</span>
<span class="sd">    such as CML or CIF which may store element information but not type information.</span>

<span class="sd">    When explicitly setting the types, you must pass `atom_types` and `atom_type_elements`.</span>
<span class="sd">    `atom_types` is a list of int type ids &gt;= 0, one for each atom in the system.</span>
<span class="sd">    `atom_type_elements` is a list of element names (e.g. &quot;C&quot;, &quot;N&quot;, &quot;Zr&quot;) per _atom type_. For</span>
<span class="sd">    example, if your system is propane, your atom_types list could be [0, 1, 1, 1] and your</span>
<span class="sd">    atom_type_elements list would then be [&quot;C&quot;, &quot;H&quot;].</span>

<span class="sd">    To specify per-atom elements, you must pass `elements` with either a list of elements, such</span>
<span class="sd">    as `Atoms(elements=[&quot;C&quot;, &quot;C&quot;], ...)` or with a string `Atoms(elements=&quot;CC&quot;, ...)`. If you</span>
<span class="sd">    use the `elements` parameter, then type ids are automatically generated.</span>

<span class="sd">    Passing `atom_type_masses` is optional, and masses will be inferred from the elements if</span>
<span class="sd">    missing. If you are using atom types with masses that do not correspond to periodic table</span>
<span class="sd">    elements, then you will need to specify the masses explicitly.</span>

<span class="sd">    Passing force field term information for `bonds`, `angles`, `dihedrals`, and `impropers` is optional, as well</span>
<span class="sd">    as passing force field coefficients for LAMMPS with `pair_coeffs`, `bond_type_coeffs`,</span>
<span class="sd">    `angle_type_coeffs`, `dihedral_type_coeffs`, and `improper_type_coeffs`.</span>

<span class="sd">    Examples:</span>

<span class="sd">    ```</span>
<span class="sd">     a = Atoms() # create an empty Atoms object with no atoms</span>
<span class="sd">     a = Atoms(atom_types=[0], positions=[[0,0,0]]) # create one atom of type 0</span>
<span class="sd">     a = Atoms(elements=[&quot;C&quot;], positions=[[0,0,0]]) # create one Carbon</span>
<span class="sd">     a = Atoms(elements=[&quot;C&quot;, &quot;C&quot;], positions=[[0,0,0], [1,0,0]]) # create two Carbons</span>
<span class="sd">     a = Atoms(elements=&quot;CC&quot;, positions=[[0,0,0], [1,0,0]]) # create two Carbons using shorthand element notation</span>
<span class="sd">    ```</span>

<span class="sd">    Args:</span>
<span class="sd">        atom_types (List[int]): list of integer type ids, one per atom.</span>
<span class="sd">        positions (List[Tuple[float, float, float]]): list of tuple atom x,y,z coordinates, one per atom.</span>
<span class="sd">        charges (List[float]): list of charges, one per atom. Defaults to 0 for each atom if not passed.</span>
<span class="sd">        groups (List[int]): list of integer groups, one per atom. For LAMMPS this gets mapped to a &quot;molecule id&quot;. Defaults to 0 for each atom if not passed.</span>
<span class="sd">        elements (List[str], str): either a list of elements, (e.g. [&quot;C&quot;, &quot;H&quot;, &quot;H&quot;, &quot;H&quot;]) or an element string (e.g. &quot;CHHH&quot;)</span>
<span class="sd">        atom_type_masses (List[float]): list of atom type masses, one per atom type. If masses are not passed, they will be inferred from the `atom_type_elements`.</span>
<span class="sd">        atom_type_elements (List[str]): list of atom type elements, one per atom type.</span>
<span class="sd">        atom_type_labels (List[str]):  list of atom type labels, one per atom type. Used in LAMMPS data file line comments as type labels.</span>
<span class="sd">        bonds (List[Tuple[int, int]]): list of bond tuples where each tuple defines a pair of atoms that are bonded. Each value in the tuple is an index of an atom in the atom_* lists.</span>
<span class="sd">        bond_types (List[int]): list of bond type id ints for each bond defined in `bonds`.</span>
<span class="sd">        angles (List[Tuple[int, int, int]]): list of angle tuples where each tuple defines a triplet of atoms making up the angle. Each value in the tuple is an index of an atom in the atom_* lists.</span>
<span class="sd">        angle_types (List[int]): list of angle type id ints for each angle defined in `angles`.</span>
<span class="sd">        dihedrals (List[Tuple[int, int, int, int]]): list of dihedral tuples where each dihedral defines a quartet of atoms making up the dihedral. Each value in the tuple is an index of an atom in the atom_* lists.</span>
<span class="sd">        dihedral_types (List[int]): list of dihedral type id ints for each dihedral defined in `dihedrals`.</span>
<span class="sd">        impropers (List[Tuple[int, int, int, int]]): list of improper tuples where each improper defines a quartet of atoms making up the improper. Each value in the tuple is an index of an atom in the atom_* lists.</span>
<span class="sd">        improper_types (List[int]): list of improper type id ints for each improper defined in `impropers`.</span>
<span class="sd">        pair_coeffs (List[str]): pair coefficients definition string (anything supported by LAMMPS in a data file but without the type id). One per atom type.</span>
<span class="sd">        bond_type_coeffs (List[str]): bond coefficients definition string (anything supported by LAMMPS in a data file but without the type id). One per bond type.</span>
<span class="sd">        angle_type_coeffs (List[str]): angle coefficients definition string (anything supported by LAMMPS in a data file but without the type id). One per angle type.</span>
<span class="sd">        dihedral_type_coeffs (List[str]): dihedral coefficients definition string (anything supported by LAMMPS in a data file but without the type id). One per dihedral type.</span>
<span class="sd">        improper_type_coeffs (List[str]): improper coefficients definition string (anything supported by LAMMPS in a data file but without the type id). One per improper type.</span>
<span class="sd">        cell (Array(3x3)): 3x3 array of unit cell vectors.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Atoms: the atoms object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">atom_type_masses</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">atom_type_masses</span><span class="p">,</span> <span class="n">ndmin</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">ndmin</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cell</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">bonds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bonds</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bond_types</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bond_types</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">angle_types</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">angle_types</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dihedrals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dihedrals</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dihedral_types</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dihedral_types</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">impropers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">impropers</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">improper_types</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">improper_types</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">pair_coeffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pair_coeffs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bond_type_coeffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bond_type_coeffs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">angle_type_coeffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">angle_type_coeffs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dihedral_type_coeffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dihedral_type_coeffs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">improper_type_coeffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">improper_type_coeffs</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">charges</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">charges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">charges</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">charges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groups</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groups</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

    <span class="c1"># load atom_types and atom_type_elements</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">atom_types</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># default case or a __getitem__ subset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom_types</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">atom_types</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom_type_elements</span> <span class="o">=</span> <span class="n">atom_type_elements</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># from element array, such as from ASE atoms or read CML</span>
        <span class="c1"># i.e. Propane [&#39;C&#39;, &#39;H&#39;, &#39;H&#39;, &#39;H&#39;, &#39;C&#39;, &#39;H&#39;, &#39;H&#39;, &#39;C&#39;, &#39;H&#39;, &#39;H&#39;, &#39;H&#39;]:</span>
        <span class="c1"># or from element string, i.e. Propane &quot;CHHHCHHCHHH&quot; (shorthand):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">elements</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">elements</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Formula</span><span class="p">(</span><span class="n">elements</span><span class="p">))</span>

        <span class="c1"># preserve order of types</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom_type_elements</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom_types</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_type_elements</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># no atom_type_elements or elements passed</span>
        <span class="c1"># this should be the `Atoms()` case; if not, it will fail the asserts below</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom_types</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([],</span> <span class="n">ndmin</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom_type_elements</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># automatically determine masses from elements if masses are not passed</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_type_masses</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_type_elements</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom_type_masses</span> <span class="o">=</span> <span class="p">[</span><span class="n">ATOMIC_MASSES</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_type_elements</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">atom_type_labels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom_type_labels</span> <span class="o">=</span> <span class="n">atom_type_labels</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: using the atom elements as the atom_type_labels since labels were not supplied.&quot;</span><span class="p">)</span>
        <span class="c1"># use default atom types equal to the element; this may not be unique!</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom_type_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_type_elements</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">assert_arrays_are_consistent_sizes</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>






  <div class="doc doc-object doc-method">



<h3 id="mofun.atoms.Atoms.extend" class="doc doc-heading">
<code class="highlight language-python"><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">offsets</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">structure_index_map</span><span class="o">=</span><span class="p">{},</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Adds other Atoms object's arrays to its own.</p>
<p>The default behavior is for all the types and params from other structure to be appended to
this structure.</p>
<p>Alternatively, an offsets tuple may be passed with the results of calling extend_types(). No
new types will be added, but the newly added atoms, bonds, etc will refer to types by their
value in the other Atoms object plus the offset. Use this when you are adding the same set
of atoms multiple times, or if your other atoms already share the same type ids as this
object. For the later case, the tuple (0,0,0,0) may be passed in.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>other</code></td>
        <td><code>Atoms</code></td>
        <td><p>atoms to add to self</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>offsets</code></td>
        <td><code></code></td>
        <td><p>an offsets tuple with the results of calling extend_types().</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>structure_index_map</code></td>
        <td><code></code></td>
        <td><p>dictionary where key is an index in other and value is an index in
self, where entries only exist if the position and element of the entries are
identical and can be considered to be the same atom.</p></td>
        <td><code>{}</code></td>
      </tr>
      <tr>
        <td><code>verbose</code></td>
        <td><code>bool</code></td>
        <td><p>print debugging info.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>mofun/atoms.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">offsets</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">structure_index_map</span><span class="o">=</span><span class="p">{},</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds other Atoms object&#39;s arrays to its own.</span>

<span class="sd">    The default behavior is for all the types and params from other structure to be appended to</span>
<span class="sd">    this structure.</span>

<span class="sd">    Alternatively, an offsets tuple may be passed with the results of calling extend_types(). No</span>
<span class="sd">    new types will be added, but the newly added atoms, bonds, etc will refer to types by their</span>
<span class="sd">    value in the other Atoms object plus the offset. Use this when you are adding the same set</span>
<span class="sd">    of atoms multiple times, or if your other atoms already share the same type ids as this</span>
<span class="sd">    object. For the later case, the tuple (0,0,0,0) may be passed in.</span>

<span class="sd">    Args:</span>
<span class="sd">        other (Atoms): atoms to add to self</span>
<span class="sd">        offsets: an offsets tuple with the results of calling extend_types().</span>
<span class="sd">        structure_index_map: dictionary where key is an index in other and value is an index in</span>
<span class="sd">            self, where entries only exist if the position and element of the entries are</span>
<span class="sd">            identical and can be considered to be the same atom.</span>
<span class="sd">        verbose (bool): print debugging info.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">atom_idx_offset</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">offsets</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;auto offset: extending types&quot;</span><span class="p">)</span>
        <span class="n">offsets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extend_types</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="c1"># update atom types for atoms that are already part of self Atoms object</span>
    <span class="k">for</span> <span class="n">other_index</span><span class="p">,</span> <span class="n">self_index</span> <span class="ow">in</span> <span class="n">structure_index_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom_types</span><span class="p">[</span><span class="n">self_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">atom_types</span><span class="p">[</span><span class="n">other_index</span><span class="p">]</span> <span class="o">+</span> <span class="n">offsets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># add atoms that are not part of self Atoms object</span>
    <span class="n">atoms_to_add</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">))</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">structure_index_map</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="n">atoms_to_add</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">atom_types</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_types</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">atom_types</span><span class="p">[</span><span class="n">atoms_to_add</span><span class="p">]</span> <span class="o">+</span> <span class="n">offsets</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">charges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">charges</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">charges</span><span class="p">[</span><span class="n">atoms_to_add</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">groups</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="n">atoms_to_add</span><span class="p">])</span>

    <span class="c1"># update structure index map</span>
    <span class="n">structure_index_map2</span> <span class="o">=</span> <span class="p">{</span><span class="n">a</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">atom_idx_offset</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">a</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">atoms_to_add</span><span class="p">)}</span>
    <span class="n">structure_index_map2</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">structure_index_map</span><span class="p">)</span>
    <span class="n">convert2structureindex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">structure_index_map2</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">find_existing_topo</span><span class="p">(</span><span class="n">topo</span><span class="p">,</span> <span class="n">new_topo</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; find existing topo tuples between the same atoms as a new topo set.</span>

<span class="sd">        Used to allow an override of an existing force field term by finding old terms between</span>
<span class="sd">        the same atoms to delete&quot;&quot;&quot;</span>

        <span class="n">existing_topo</span> <span class="o">=</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">topo</span><span class="p">]</span>
        <span class="n">new_topo_tuples</span> <span class="o">=</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">new_topo</span><span class="p">]</span>
        <span class="n">existing_topo_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">existing_topo</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">new_topo_tuples</span> <span class="k">if</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">existing_topo</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">existing_topo_indices</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">bonds</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">new_bonds</span> <span class="o">=</span> <span class="n">convert2structureindex</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">bonds</span><span class="p">)</span>
        <span class="n">existing_bond_indices</span> <span class="o">=</span> <span class="n">find_existing_topo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds</span><span class="p">,</span> <span class="n">new_bonds</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bonds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds</span><span class="p">,</span> <span class="n">new_bonds</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bond_types</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bond_types</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">bond_types</span> <span class="o">+</span> <span class="n">offsets</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bonds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds</span><span class="p">,</span> <span class="n">existing_bond_indices</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bond_types</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bond_types</span><span class="p">,</span> <span class="n">existing_bond_indices</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">angles</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">new_angles</span> <span class="o">=</span> <span class="n">convert2structureindex</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">angles</span><span class="p">)</span>
        <span class="n">existing_angle_indices</span> <span class="o">=</span> <span class="n">find_existing_topo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="p">,</span> <span class="n">new_angles</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="p">,</span> <span class="n">new_angles</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angle_types</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle_types</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">angle_types</span> <span class="o">+</span> <span class="n">offsets</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="p">,</span> <span class="n">existing_angle_indices</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angle_types</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle_types</span><span class="p">,</span> <span class="n">existing_angle_indices</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">dihedrals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">new_dihedrals</span> <span class="o">=</span> <span class="n">convert2structureindex</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">dihedrals</span><span class="p">)</span>
        <span class="n">existing_dihedral_indices</span> <span class="o">=</span> <span class="n">find_existing_topo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dihedrals</span><span class="p">,</span> <span class="n">new_dihedrals</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dihedrals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dihedrals</span><span class="p">,</span> <span class="n">new_dihedrals</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dihedral_types</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dihedral_types</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">dihedral_types</span> <span class="o">+</span> <span class="n">offsets</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dihedrals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dihedrals</span><span class="p">,</span> <span class="n">existing_dihedral_indices</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dihedral_types</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dihedral_types</span><span class="p">,</span> <span class="n">existing_dihedral_indices</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">impropers</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">new_impropers</span> <span class="o">=</span> <span class="n">convert2structureindex</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">impropers</span><span class="p">)</span>
        <span class="n">existing_improper_indices</span> <span class="o">=</span> <span class="n">find_existing_topo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">impropers</span><span class="p">,</span> <span class="n">new_impropers</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">impropers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">impropers</span><span class="p">,</span> <span class="n">new_impropers</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">improper_types</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">improper_types</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">improper_types</span> <span class="o">+</span> <span class="n">offsets</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">impropers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">impropers</span><span class="p">,</span> <span class="n">existing_improper_indices</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">improper_types</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">improper_types</span><span class="p">,</span> <span class="n">existing_improper_indices</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">assert_arrays_are_consistent_sizes</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h3 id="mofun.atoms.Atoms.from_ase_atoms" class="doc doc-heading">
<code class="highlight language-python"><span class="n">from_ase_atoms</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Create an Atoms object from an ASE Atoms object.</p>
<p>Only supports importing the atom positions, elements, and the unit cell.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>atoms</code></td>
        <td><code>ASE Atoms object</code></td>
        <td><p>atoms to load from</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Atoms</code></td>
      <td><p>atoms loaded from an ASE Atoms object.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>mofun/atoms.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_ase_atoms</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">atoms</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create an Atoms object from an ASE Atoms object.</span>

<span class="sd">    Only supports importing the atom positions, elements, and the unit cell.</span>

<span class="sd">    Args:</span>
<span class="sd">        atoms (ASE Atoms object): atoms to load from</span>

<span class="sd">    Returns:</span>
<span class="sd">        Atoms: atoms loaded from an ASE Atoms object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">elements</span><span class="o">=</span><span class="n">atoms</span><span class="o">.</span><span class="n">symbols</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="n">atoms</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">atoms</span><span class="o">.</span><span class="n">cell</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h3 id="mofun.atoms.Atoms.load" class="doc doc-heading">
<code class="highlight language-python"><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Creates an Atoms object from either a path or a file object and filetype.</p>
<p>Can load any of the supported types:</p>
<ul>
<li>lammps data file: "lmpdat"</li>
<li>cif</li>
<li>cml</li>
</ul>
<p>Only the lammps data file and cif support reading from a file object, presently, due to the
other formats depending on external library support.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>f</code></td>
        <td><code>Str or Path or File</code></td>
        <td><p>either a path to a file or an open File to load from</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>filetype</code></td>
        <td><code>Str</code></td>
        <td><p>filetype ('lmpdat', 'cif', or 'cml') of passed f File object, or
explicit filetype to override default filetype implied from file extension.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>kwargs</code></td>
        <td><code></code></td>
        <td><p>keyword args passed on to individual load functions.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>mofun/atoms.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Creates an Atoms object from either a path or a file object and filetype.</span>

<span class="sd">    Can load any of the supported types:</span>

<span class="sd">    - lammps data file: &quot;lmpdat&quot;</span>
<span class="sd">    - cif</span>
<span class="sd">    - cml</span>

<span class="sd">    Only the lammps data file and cif support reading from a file object, presently, due to the</span>
<span class="sd">    other formats depending on external library support.</span>

<span class="sd">    Args:</span>
<span class="sd">        f (Str or Path or File): either a path to a file or an open File to load from</span>
<span class="sd">        filetype (Str): filetype (&#39;lmpdat&#39;, &#39;cif&#39;, or &#39;cml&#39;) of passed f File object, or</span>
<span class="sd">            explicit filetype to override default filetype implied from file extension.</span>
<span class="sd">        kwargs: keyword args passed on to individual load functions.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fd</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">path</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">TextIOBase</span><span class="p">):</span>
        <span class="n">fd</span> <span class="o">=</span> <span class="n">f</span>
        <span class="k">if</span> <span class="n">filetype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;If a File object is passed, a filetype must be passed with it&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># other cases are treated as either Pathlib path or strings</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">f</span>
        <span class="k">if</span> <span class="n">filetype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">filetype</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="n">filetype</span> <span class="o">=</span> <span class="n">filetype</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="k">if</span> <span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;lmpdat&quot;</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">use_or_open</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
            <span class="n">atoms</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">load_lmpdat</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">atoms</span>
    <span class="k">elif</span> <span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;cml&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Loading a cml file requires a path&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">load_cml</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;cif&quot;</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">use_or_open</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">load_cif</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unsupported filetype&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="mofun.atoms.Atoms.load_cif" class="doc doc-heading">
<code class="highlight language-python"><span class="n">load_cif</span><span class="p">(</span><span class="n">f</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Loads a CIF file, including bonding information.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>f</code></td>
        <td><code>File</code></td>
        <td><p>File-like object to read from.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Atoms</code></td>
      <td><p>loaded Atoms object</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>mofun/atoms.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">load_cif</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Loads a CIF file, including bonding information.</span>

<span class="sd">    Args:</span>
<span class="sd">        f (File): File-like object to read from.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Atoms: loaded Atoms object</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">has_all_tags</span><span class="p">(</span><span class="n">block</span><span class="p">,</span> <span class="n">tags</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">block</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span> <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>

    <span class="c1"># PyCifRw supports file descriptors and path strings, but doesn&#39;t not support PathLib paths.</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">PurePath</span><span class="p">):</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="n">cf</span> <span class="o">=</span> <span class="n">read_cif</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">block</span> <span class="o">=</span> <span class="n">cf</span><span class="p">[</span><span class="n">cf</span><span class="o">.</span><span class="n">get_roots</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>

    <span class="n">cart_coord_tags</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;_atom_site_Cartn_x&quot;</span><span class="p">,</span> <span class="s2">&quot;_atom_site_Cartn_y&quot;</span><span class="p">,</span> <span class="s2">&quot;_atom_site_Cartn_z&quot;</span><span class="p">,</span> <span class="s2">&quot;_atom_site_label&quot;</span><span class="p">]</span>
    <span class="n">fract_coord_tags</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;_atom_site_fract_x&quot;</span><span class="p">,</span> <span class="s2">&quot;_atom_site_fract_y&quot;</span><span class="p">,</span> <span class="s2">&quot;_atom_site_fract_z&quot;</span><span class="p">,</span> <span class="s2">&quot;_atom_site_label&quot;</span><span class="p">]</span>
    <span class="n">use_fract_coords</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">has_all_tags</span><span class="p">(</span><span class="n">block</span><span class="p">,</span> <span class="n">cart_coord_tags</span><span class="p">):</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="n">block</span><span class="p">[</span><span class="n">lbl</span><span class="p">]</span> <span class="k">for</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="n">cart_coord_tags</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">has_all_tags</span><span class="p">(</span><span class="n">block</span><span class="p">,</span> <span class="n">fract_coord_tags</span><span class="p">):</span>
        <span class="n">use_fract_coords</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="n">block</span><span class="p">[</span><span class="n">lbl</span><span class="p">]</span> <span class="k">for</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="n">fract_coord_tags</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span><span class="p">(</span><span class="s2">&quot;no fractional or cartesian coords in CIF file&quot;</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">z</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>

    <span class="n">atom_name</span> <span class="o">=</span> <span class="n">coords</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>

    <span class="n">atom_types</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="s1">&#39;_atom_site_type_symbol&#39;</span><span class="p">]</span>

    <span class="n">charges</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">block</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="s1">&#39;_atom_site_charge&#39;</span><span class="p">):</span>
        <span class="n">charges</span> <span class="o">=</span> <span class="n">block</span><span class="p">[</span><span class="s1">&#39;_atom_site_charge&#39;</span><span class="p">]</span>

    <span class="n">bonds</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">bond_tags</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;_geom_bond_atom_site_label_1&quot;</span><span class="p">,</span> <span class="s2">&quot;_geom_bond_atom_site_label_2&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">has_all_tags</span><span class="p">(</span><span class="n">block</span><span class="p">,</span> <span class="n">bond_tags</span><span class="p">):</span>
        <span class="n">cifbonds</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">block</span><span class="p">[</span><span class="n">lbl</span><span class="p">]</span> <span class="k">for</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="n">bond_tags</span><span class="p">])</span>
        <span class="n">bonds</span> <span class="o">=</span> <span class="p">[(</span><span class="n">atom_name</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">atom_name</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">b</span><span class="p">))</span> <span class="k">for</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="ow">in</span> <span class="n">cifbonds</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: cif read doesn&#39;t handle bond types at present; bonding info is discarded. Use LAMMPS data file format if you need bonds&quot;</span><span class="p">)</span>
        <span class="n">bonds</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">cell</span><span class="o">=</span><span class="kc">None</span>
    <span class="n">cell_tags</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;_cell_length_a&#39;</span><span class="p">,</span> <span class="s1">&#39;_cell_length_b&#39;</span><span class="p">,</span> <span class="s1">&#39;_cell_length_c&#39;</span><span class="p">,</span> <span class="s1">&#39;_cell_angle_alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;_cell_angle_beta&#39;</span><span class="p">,</span> <span class="s1">&#39;_cell_angle_gamma&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">has_all_tags</span><span class="p">(</span><span class="n">block</span><span class="p">,</span> <span class="n">cell_tags</span><span class="p">):</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="n">tag</span><span class="p">])</span> <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">cell_tags</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">alpha</span> <span class="o">!=</span> <span class="mf">90.</span> <span class="ow">or</span> <span class="n">beta</span> <span class="o">!=</span> <span class="mi">90</span> <span class="ow">or</span> <span class="n">gamma</span> <span class="o">!=</span> <span class="mf">90.</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;No support for non orthorhombic UCs at the moment!&quot;</span><span class="p">)</span>

        <span class="n">cell</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">use_fract_coords</span><span class="p">:</span>
            <span class="n">positions</span> <span class="o">*=</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">elements</span><span class="o">=</span><span class="n">atom_types</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="n">positions</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">,</span> <span class="n">charges</span><span class="o">=</span><span class="n">charges</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="mofun.atoms.Atoms.load_cml" class="doc doc-heading">
<code class="highlight language-python"><span class="n">load_cml</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Loads a CML file, including bonding information.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>f</code></td>
        <td><code>File</code></td>
        <td><p>File-like object to read from.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Atoms</code></td>
      <td><p>loaded Atoms object</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>mofun/atoms.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">load_cml</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Loads a CML file, including bonding information.</span>

<span class="sd">    Args:</span>
<span class="sd">        f (File): File-like object to read from.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Atoms: loaded Atoms object</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span>

    <span class="n">atom_dicts</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">attrib</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;.//atom&#39;</span><span class="p">)]</span>
    <span class="n">atom_tuples</span> <span class="o">=</span> <span class="p">[(</span><span class="n">a</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="s1">&#39;elementType&#39;</span><span class="p">],</span>
                   <span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="s1">&#39;x3&#39;</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="s1">&#39;y3&#39;</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="s1">&#39;z3&#39;</span><span class="p">]))</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">atom_dicts</span><span class="p">]</span>
    <span class="n">ids</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">atom_tuples</span><span class="p">)</span>
    <span class="n">id_to_idx</span> <span class="o">=</span> <span class="p">{</span><span class="nb">id</span><span class="p">:</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="nb">id</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ids</span><span class="p">)}</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>

    <span class="n">bond_dicts</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">attrib</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;.//bond&#39;</span><span class="p">)]</span>
    <span class="n">bond_tuples</span> <span class="o">=</span> <span class="p">[(</span><span class="n">a</span><span class="p">[</span><span class="s1">&#39;atomRefs2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">]))</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">bond_dicts</span><span class="p">]</span>
    <span class="n">bonds_by_ids</span><span class="p">,</span> <span class="n">bond_orders</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">bond_tuples</span><span class="p">)</span>
    <span class="n">bonds</span> <span class="o">=</span> <span class="p">[(</span><span class="n">id_to_idx</span><span class="p">[</span><span class="n">b1</span><span class="p">],</span> <span class="n">id_to_idx</span><span class="p">[</span><span class="n">b2</span><span class="p">])</span> <span class="k">for</span> <span class="p">(</span><span class="n">b1</span><span class="p">,</span><span class="n">b2</span><span class="p">)</span> <span class="ow">in</span> <span class="n">bonds_by_ids</span><span class="p">]</span>
    <span class="n">bond_types</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">bonds</span><span class="p">]</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">elements</span><span class="o">=</span><span class="n">elements</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="n">positions</span><span class="p">,</span> <span class="n">bonds</span><span class="o">=</span><span class="n">bonds</span><span class="p">,</span> <span class="n">bond_types</span><span class="o">=</span><span class="n">bond_types</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="mofun.atoms.Atoms.load_lmpdat" class="doc doc-heading">
<code class="highlight language-python"><span class="n">load_lmpdat</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">atom_format</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">,</span> <span class="n">guess_atol</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Load Atoms object from lammps data file (.lmpdat) format.</p>
<p>LAMMPS data files store only atom ids and masses, but do not store two other things we need:
elements and atom type labels. These are the rules for inferring atom type labels and elements.</p>
<p>In priority order, for elements, we:</p>
<ol>
<li>guess the elements using the masses by seeing if there is a periodic table element within
0.1 g/mol of the mass. If any atom types doe not match to an existing periodic table
element, this method fails.</li>
<li>use the atom ids as the elements (and print a warning).</li>
</ol>
<p>In priority order, for atom type labels, we:</p>
<ol>
<li>use the comments after each line in the Masses section as the atom type. If any line is
missing a comment, this method fails.</li>
<li>use the elements, if we have them.</li>
<li>use the atom ids (and print a warning).</li>
</ol>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>f</code></td>
        <td><code>File</code></td>
        <td><p>File-like object to read from.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>atom_format</code></td>
        <td><code>str</code></td>
        <td><p>atom format of lammps data file. Currently supported atom formats are
'full' and 'atomic'.</p></td>
        <td><code>&#39;full&#39;</code></td>
      </tr>
      <tr>
        <td><code>guess_atol</code></td>
        <td><code>float</code></td>
        <td><p>absolute tolerance a read mass can differ from a periodic table mass
and still be considered that element. Default: 0.1.</p></td>
        <td><code>0.1</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Atoms</code></td>
      <td><p>loaded Atoms object</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>mofun/atoms.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">load_lmpdat</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">atom_format</span><span class="o">=</span><span class="s2">&quot;full&quot;</span><span class="p">,</span> <span class="n">guess_atol</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Load Atoms object from lammps data file (.lmpdat) format.</span>

<span class="sd">    LAMMPS data files store only atom ids and masses, but do not store two other things we need:</span>
<span class="sd">    elements and atom type labels. These are the rules for inferring atom type labels and elements.</span>

<span class="sd">    In priority order, for elements, we:</span>

<span class="sd">    1. guess the elements using the masses by seeing if there is a periodic table element within</span>
<span class="sd">    0.1 g/mol of the mass. If any atom types doe not match to an existing periodic table</span>
<span class="sd">    element, this method fails.</span>
<span class="sd">    2. use the atom ids as the elements (and print a warning).</span>

<span class="sd">    In priority order, for atom type labels, we:</span>

<span class="sd">    1. use the comments after each line in the Masses section as the atom type. If any line is</span>
<span class="sd">    missing a comment, this method fails.</span>
<span class="sd">    2. use the elements, if we have them.</span>
<span class="sd">    3. use the atom ids (and print a warning).</span>

<span class="sd">    Args:</span>
<span class="sd">        f (File): File-like object to read from.</span>
<span class="sd">        atom_format (str): atom format of lammps data file. Currently supported atom formats are</span>
<span class="sd">            &#39;full&#39; and &#39;atomic&#39;.</span>
<span class="sd">        guess_atol (float): absolute tolerance a read mass can differ from a periodic table mass</span>
<span class="sd">            and still be considered that element. Default: 0.1.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Atoms: loaded Atoms object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">get_types_tups</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
        <span class="n">types</span> <span class="o">=</span> <span class="n">tups</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">types</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">tups</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">types</span><span class="p">,</span> <span class="n">tups</span>

    <span class="n">masses</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">atoms</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">bonds</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">angles</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dihedrals</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">impropers</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">pair_coeffs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">bond_coeffs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">angle_coeffs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dihedral_coeffs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">improper_coeffs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">atom_type_labels</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">atom_type_elements</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">cellx</span> <span class="o">=</span> <span class="n">celly</span> <span class="o">=</span> <span class="n">cellz</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="n">sections_handled</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Pair Coeffs&quot;</span><span class="p">,</span> <span class="s2">&quot;Bond Coeffs&quot;</span><span class="p">,</span> <span class="s2">&quot;Angle Coeffs&quot;</span><span class="p">,</span> <span class="s2">&quot;Dihedral Coeffs&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Improper Coeffs&quot;</span><span class="p">,</span> <span class="s2">&quot;Atoms&quot;</span><span class="p">,</span> <span class="s2">&quot;Bonds&quot;</span><span class="p">,</span> <span class="s2">&quot;Angles&quot;</span><span class="p">,</span> <span class="s2">&quot;Dihedrals&quot;</span><span class="p">,</span> <span class="s2">&quot;Impropers&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Masses&quot;</span><span class="p">]</span>
    <span class="n">current_section</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">start_section</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">for</span> <span class="n">unprocessed_line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
        <span class="c1"># handle comments</span>
        <span class="n">comment_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">comment</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="s2">&quot;#&quot;</span> <span class="ow">in</span> <span class="n">unprocessed_line</span><span class="p">:</span>
            <span class="n">line</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">unprocessed_line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)</span>
            <span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">comment_string</span> <span class="o">=</span><span class="s2">&quot;   # &quot;</span> <span class="o">+</span> <span class="n">comment</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">unprocessed_line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">sections_handled</span><span class="p">:</span>
            <span class="n">current_section</span> <span class="o">=</span> <span class="n">line</span>
            <span class="n">start_section</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">continue</span>
        <span class="k">elif</span> <span class="n">line</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">start_section</span><span class="p">:</span>
                <span class="c1"># end of section or blank</span>
                <span class="n">current_section</span><span class="o">=</span> <span class="kc">None</span>
            <span class="n">start_section</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">continue</span>
        <span class="n">tup</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">current_section</span> <span class="o">==</span> <span class="s2">&quot;Masses&quot;</span><span class="p">:</span>
            <span class="n">masses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">atom_type_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">current_section</span> <span class="o">==</span> <span class="s2">&quot;Pair Coeffs&quot;</span><span class="p">:</span>
            <span class="n">pair_coeffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">:]),</span> <span class="n">comment_string</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">current_section</span> <span class="o">==</span> <span class="s2">&quot;Bond Coeffs&quot;</span><span class="p">:</span>
            <span class="n">bond_coeffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">:]),</span> <span class="n">comment_string</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">current_section</span> <span class="o">==</span> <span class="s2">&quot;Angle Coeffs&quot;</span><span class="p">:</span>
            <span class="n">angle_coeffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot;  &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">:]),</span> <span class="n">comment_string</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">current_section</span> <span class="o">==</span> <span class="s2">&quot;Dihedral Coeffs&quot;</span><span class="p">:</span>
            <span class="n">dihedral_coeffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">:]),</span> <span class="n">comment_string</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">current_section</span> <span class="o">==</span> <span class="s2">&quot;Improper Coeffs&quot;</span><span class="p">:</span>
            <span class="n">improper_coeffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">:]),</span> <span class="n">comment_string</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">current_section</span> <span class="o">==</span> <span class="s2">&quot;Atoms&quot;</span><span class="p">:</span>
            <span class="n">atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tup</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">current_section</span> <span class="o">==</span> <span class="s2">&quot;Bonds&quot;</span><span class="p">:</span>
            <span class="n">bonds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tup</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">current_section</span> <span class="o">==</span> <span class="s2">&quot;Angles&quot;</span><span class="p">:</span>
            <span class="n">angles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tup</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">current_section</span> <span class="o">==</span> <span class="s2">&quot;Dihedrals&quot;</span><span class="p">:</span>
            <span class="n">dihedrals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tup</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">current_section</span> <span class="o">==</span> <span class="s2">&quot;Impropers&quot;</span><span class="p">:</span>
            <span class="n">impropers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tup</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">current_section</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;xlo xhi&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">cellx</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">elif</span> <span class="s2">&quot;ylo yhi&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">celly</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">elif</span> <span class="s2">&quot;zlo zhi&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">cellz</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">float</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">cell</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">cellx</span> <span class="o">&gt;</span> <span class="mf">0.</span> <span class="ow">and</span> <span class="n">celly</span> <span class="o">&gt;</span> <span class="mf">0.</span> <span class="ow">and</span> <span class="n">cellz</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">:</span>
        <span class="n">cell</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">cellx</span><span class="p">,</span> <span class="n">celly</span><span class="p">,</span> <span class="n">cellz</span><span class="p">)</span>
    <span class="n">atom_type_masses</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">masses</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">atoms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">bonds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bonds</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">dihedrals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dihedrals</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">impropers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">impropers</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

    <span class="c1"># note: bond indices in lmpdat file are 1-indexed and we are 0-indexed which is why</span>
    <span class="c1"># the bond pairs get a -1</span>
    <span class="k">if</span> <span class="n">atom_format</span> <span class="o">==</span> <span class="s2">&quot;atomic&quot;</span><span class="p">:</span>
        <span class="n">atom_types</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">atoms</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">groups</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atom_types</span><span class="p">))</span>
        <span class="n">charges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atom_types</span><span class="p">))</span>
        <span class="n">atom_tups</span> <span class="o">=</span> <span class="n">atoms</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">atom_format</span> <span class="o">==</span> <span class="s2">&quot;full&quot;</span><span class="p">:</span>
        <span class="n">groups</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">atoms</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">atom_types</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">atoms</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">charges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">atoms</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">atom_tups</span> <span class="o">=</span> <span class="n">atoms</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span>

    <span class="c1"># guess the atom elements; if this fails, use the atoms ids as the elements</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">atom_type_elements</span> <span class="o">=</span> <span class="n">guess_elements_from_masses</span><span class="p">(</span><span class="n">atom_type_masses</span><span class="p">,</span> <span class="n">max_delta</span><span class="o">=</span><span class="n">guess_atol</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: using type ids for elements since some masses do not correspond to periodic table elements within the set tolerance.&quot;</span><span class="p">)</span>
        <span class="n">atom_type_elements</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">masses</span><span class="p">))]</span>

    <span class="c1"># infer the atom type labels</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">atom_type_labels</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="c1"># then loading atom types from the labels worked</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: using elements for atom type labels since there is not an atom type label comment for every atom type in the Masses section.&quot;</span><span class="p">)</span>
        <span class="n">atom_type_labels</span> <span class="o">=</span> <span class="n">atom_type_elements</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>


    <span class="n">bond_types</span><span class="p">,</span> <span class="n">bond_tups</span> <span class="o">=</span> <span class="n">get_types_tups</span><span class="p">(</span><span class="n">bonds</span><span class="p">)</span>
    <span class="n">angle_types</span><span class="p">,</span> <span class="n">angle_tups</span> <span class="o">=</span> <span class="n">get_types_tups</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span>
    <span class="n">dihedral_types</span><span class="p">,</span> <span class="n">dihedral_tups</span> <span class="o">=</span> <span class="n">get_types_tups</span><span class="p">(</span><span class="n">dihedrals</span><span class="p">)</span>
    <span class="n">improper_types</span><span class="p">,</span> <span class="n">improper_tups</span> <span class="o">=</span> <span class="n">get_types_tups</span><span class="p">(</span><span class="n">impropers</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">atom_types</span><span class="o">=</span><span class="n">atom_types</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="n">atom_tups</span><span class="p">,</span> <span class="n">charges</span><span class="o">=</span><span class="n">charges</span><span class="p">,</span>
               <span class="n">atom_type_masses</span><span class="o">=</span><span class="n">atom_type_masses</span><span class="p">,</span> <span class="n">atom_type_elements</span><span class="o">=</span><span class="n">atom_type_elements</span><span class="p">,</span>
               <span class="n">bond_types</span><span class="o">=</span><span class="n">bond_types</span><span class="p">,</span> <span class="n">bonds</span><span class="o">=</span><span class="n">bond_tups</span><span class="p">,</span>
               <span class="n">angle_types</span><span class="o">=</span><span class="n">angle_types</span><span class="p">,</span> <span class="n">angles</span><span class="o">=</span><span class="n">angle_tups</span><span class="p">,</span>
               <span class="n">dihedral_types</span><span class="o">=</span><span class="n">dihedral_types</span><span class="p">,</span> <span class="n">dihedrals</span><span class="o">=</span><span class="n">dihedral_tups</span><span class="p">,</span>
               <span class="n">improper_types</span><span class="o">=</span><span class="n">improper_types</span><span class="p">,</span> <span class="n">impropers</span><span class="o">=</span><span class="n">improper_tups</span><span class="p">,</span>
               <span class="n">pair_coeffs</span><span class="o">=</span><span class="n">pair_coeffs</span><span class="p">,</span> <span class="n">bond_type_coeffs</span><span class="o">=</span><span class="n">bond_coeffs</span><span class="p">,</span>
               <span class="n">angle_type_coeffs</span><span class="o">=</span><span class="n">angle_coeffs</span><span class="p">,</span> <span class="n">dihedral_type_coeffs</span><span class="o">=</span><span class="n">dihedral_coeffs</span><span class="p">,</span>
               <span class="n">improper_type_coeffs</span><span class="o">=</span><span class="n">improper_coeffs</span><span class="p">,</span> <span class="n">atom_type_labels</span><span class="o">=</span><span class="n">atom_type_labels</span><span class="p">,</span>
               <span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span> <span class="n">cell</span><span class="o">=</span><span class="n">cell</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h3 id="mofun.atoms.Atoms.replicate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">replicate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">repldims</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Replicate atoms object across xyz dimensions</p>
<p>Warnings:</p>
<ul>
<li>only works for orthorhombic at the moment!</li>
<li>does not magically handle any bonds that may cross periodic boundary conditions!</li>
</ul>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>repldims</code></td>
        <td><code>Tuple(int, int, int</code></td>
        <td><p>number of times to replicate in each dimension</p></td>
        <td><code>(1, 1, 1)</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Atoms</code></td>
      <td><p>replicated atoms.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>mofun/atoms.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">replicate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">repldims</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)):</span>
    <span class="sd">&quot;&quot;&quot;Replicate atoms object across xyz dimensions</span>

<span class="sd">    Warnings:</span>

<span class="sd">    * only works for orthorhombic at the moment!</span>
<span class="sd">    * does not magically handle any bonds that may cross periodic boundary conditions!</span>

<span class="sd">    Args:</span>
<span class="sd">        repldims (Tuple(int, int, int)): number of times to replicate in each dimension</span>

<span class="sd">    Returns:</span>
<span class="sd">        Atoms: replicated atoms.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">repl_atoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">ucmults</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">repldims</span><span class="p">]))</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">ucmults</span> <span class="o">=</span> <span class="n">ucmults</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">ucmults</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span> <span class="c1"># remove [0,0,0] since in copy</span>
    <span class="k">for</span> <span class="n">ucmult</span> <span class="ow">in</span> <span class="n">ucmults</span><span class="p">:</span>
        <span class="n">transatoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">transatoms</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">transatoms</span><span class="o">.</span><span class="n">cell</span><span class="p">,</span> <span class="n">ucmult</span><span class="p">))</span>
        <span class="n">repl_atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">transatoms</span><span class="p">,</span> <span class="n">offsets</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>

    <span class="n">repl_atoms</span><span class="o">.</span><span class="n">cell</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell</span> <span class="o">*</span> <span class="n">repldims</span>
    <span class="k">return</span> <span class="n">repl_atoms</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="mofun.atoms.Atoms.save" class="doc doc-heading">
<code class="highlight language-python"><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Saves an Atoms object to either a path or a file object and filetype.</p>
<p>Can save any of the supported types:</p>
<ul>
<li>lammps data file: "lmpdat"</li>
<li>mol</li>
</ul>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>f</code></td>
        <td><code>Str or Path or File</code></td>
        <td><p>either a path to a file or an open File to save to</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>filetype</code></td>
        <td><code>Str</code></td>
        <td><p>filetype ('lmpdat', 'cif', or 'cml') of passed f File object, or
explicit filetype to override default filetype implied from file extension.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>kwargs</code></td>
        <td><code></code></td>
        <td><p>keyword args passed on to individual save functions.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>mofun/atoms.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Saves an Atoms object to either a path or a file object and filetype.</span>

<span class="sd">    Can save any of the supported types:</span>

<span class="sd">    - lammps data file: &quot;lmpdat&quot;</span>
<span class="sd">    - mol</span>

<span class="sd">    Args:</span>
<span class="sd">        f (Str or Path or File): either a path to a file or an open File to save to</span>
<span class="sd">        filetype (Str): filetype (&#39;lmpdat&#39;, &#39;cif&#39;, or &#39;cml&#39;) of passed f File object, or</span>
<span class="sd">            explicit filetype to override default filetype implied from file extension.</span>
<span class="sd">        kwargs: keyword args passed on to individual save functions.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fd</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">path</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">TextIOBase</span><span class="p">):</span>
        <span class="n">fd</span> <span class="o">=</span> <span class="n">f</span>
        <span class="k">if</span> <span class="n">filetype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;If a File object is passed, a filetype must be passed with it&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># other cases are treated as either Pathlib path or strings</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">f</span>
        <span class="k">if</span> <span class="n">filetype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">filetype</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="n">filetype</span> <span class="o">=</span> <span class="n">filetype</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="k">if</span> <span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;lmpdat&quot;</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">use_or_open</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
            <span class="n">atoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_lmpdat</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">atoms</span>
    <span class="k">elif</span> <span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;mol&quot;</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">use_or_open</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_mol</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unsupported filetype&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="mofun.atoms.Atoms.save_lmpdat" class="doc doc-heading">
<code class="highlight language-python"><span class="n">save_lmpdat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">atom_format</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">,</span> <span class="n">file_comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Saves a lmpdat file</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>f</code></td>
        <td><code>File</code></td>
        <td><p>an open file to write to</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>atom_format</code></td>
        <td><code>str</code></td>
        <td><p>LAMMPS atom format. Supports only 'atomic' and 'full'.</p></td>
        <td><code>&#39;full&#39;</code></td>
      </tr>
      <tr>
        <td><code>file_comment</code></td>
        <td><code>str</code></td>
        <td><p>written in first line of output file.</p></td>
        <td><code>&#39;&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>mofun/atoms.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">save_lmpdat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">atom_format</span><span class="o">=</span><span class="s2">&quot;full&quot;</span><span class="p">,</span> <span class="n">file_comment</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Saves a lmpdat file</span>

<span class="sd">    Args:</span>
<span class="sd">        f (File): an open file to write to</span>
<span class="sd">        atom_format (str): LAMMPS atom format. Supports only &#39;atomic&#39; and &#39;full&#39;.</span>
<span class="sd">        file_comment (str): written in first line of output file.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> (written by mofun)</span><span class="se">\n\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">file_comment</span><span class="p">)</span>

    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> atoms</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_types</span><span class="p">))</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> bonds</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bond_types</span><span class="p">))</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> angles</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle_types</span><span class="p">))</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> dihedrals</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dihedral_types</span><span class="p">))</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> impropers</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">improper_types</span><span class="p">))</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_atom_types</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> atom types</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_atom_types</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_bond_types</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> bond types</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_bond_types</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_angle_types</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> angle types</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_angle_types</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_dihedral_types</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> dihedral types</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_dihedral_types</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_improper_types</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> improper types</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_improper_types</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">xlohi</span><span class="p">,</span> <span class="n">ylohi</span><span class="p">,</span> <span class="n">zlohi</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; </span><span class="si">%10.6f</span><span class="s2"> </span><span class="si">%10.6f</span><span class="s2"> xlo xhi</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">xlohi</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; </span><span class="si">%10.6f</span><span class="s2"> </span><span class="si">%10.6f</span><span class="s2"> ylo yhi</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ylohi</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; </span><span class="si">%10.6f</span><span class="s2"> </span><span class="si">%10.6f</span><span class="s2"> zlo zhi</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">zlohi</span><span class="p">)</span>

    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Masses</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_type_masses</span><span class="p">):</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; </span><span class="si">%d</span><span class="s2"> </span><span class="si">%10.6f</span><span class="s2">   # </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_atoms</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pair_coeffs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Pair Coeffs</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coeffs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pair_coeffs</span><span class="p">):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%d</span><span class="s1"> </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bond_type_coeffs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Bond Coeffs</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coeffs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bond_type_coeffs</span><span class="p">):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%d</span><span class="s1"> </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle_type_coeffs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Angle Coeffs</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coeffs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle_type_coeffs</span><span class="p">):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%d</span><span class="s1"> </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dihedral_type_coeffs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Dihedral Coeffs</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coeffs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dihedral_type_coeffs</span><span class="p">):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%d</span><span class="s1"> </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">improper_type_coeffs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Improper Coeffs</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coeffs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">improper_type_coeffs</span><span class="p">):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; </span><span class="si">%d</span><span class="s1"> </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">))</span>

    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Atoms</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">atom_format</span> <span class="o">==</span> <span class="s2">&quot;atomic&quot;</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; </span><span class="si">%d</span><span class="s2"> </span><span class="si">%d</span><span class="s2"> </span><span class="si">%10.6f</span><span class="s2"> </span><span class="si">%10.6f</span><span class="s2"> </span><span class="si">%10.6f</span><span class="s2">   # </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_types</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_atoms</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_types</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
    <span class="k">elif</span> <span class="n">atom_format</span> <span class="o">==</span> <span class="s2">&quot;full&quot;</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; </span><span class="si">%d</span><span class="s2"> </span><span class="si">%d</span><span class="s2"> </span><span class="si">%d</span><span class="s2"> </span><span class="si">%10.6f</span><span class="s2"> </span><span class="si">%10.6f</span><span class="s2"> </span><span class="si">%10.6f</span><span class="s2"> </span><span class="si">%10.6f</span><span class="s2">   # </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span>
                <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_types</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">charges</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_atoms</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atom_types</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Bonds</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tup</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bonds</span><span class="p">):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; </span><span class="si">%d</span><span class="s2"> </span><span class="si">%d</span><span class="s2"> </span><span class="si">%d</span><span class="s2"> </span><span class="si">%d</span><span class="s2">   # </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bond_types</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tup</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_atoms</span><span class="p">(</span><span class="n">tup</span><span class="p">,</span> <span class="n">atom_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Angles</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tup</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="p">):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; </span><span class="si">%d</span><span class="s2"> </span><span class="si">%d</span><span class="s2"> </span><span class="si">%d</span><span class="s2"> </span><span class="si">%d</span><span class="s2"> </span><span class="si">%d</span><span class="s2">   # </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_types</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tup</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_atoms</span><span class="p">(</span><span class="n">tup</span><span class="p">,</span> <span class="n">atom_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dihedrals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Dihedrals</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tup</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dihedrals</span><span class="p">):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; </span><span class="si">%d</span><span class="s2"> </span><span class="si">%d</span><span class="s2"> </span><span class="si">%d</span><span class="s2"> </span><span class="si">%d</span><span class="s2"> </span><span class="si">%d</span><span class="s2"> </span><span class="si">%d</span><span class="s2">   # </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dihedral_types</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tup</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_atoms</span><span class="p">(</span><span class="n">tup</span><span class="p">,</span> <span class="n">atom_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">impropers</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Impropers</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tup</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">impropers</span><span class="p">):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; </span><span class="si">%d</span><span class="s2"> </span><span class="si">%d</span><span class="s2"> </span><span class="si">%d</span><span class="s2"> </span><span class="si">%d</span><span class="s2"> </span><span class="si">%d</span><span class="s2"> </span><span class="si">%d</span><span class="s2">   # </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">improper_types</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">tup</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_atoms</span><span class="p">(</span><span class="n">tup</span><span class="p">,</span> <span class="n">atom_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="mofun.atoms.Atoms.save_mol" class="doc doc-heading">
<code class="highlight language-python"><span class="n">save_mol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">file_comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Writes .mol file for structural information.</p>

        <details class="quote">
          <summary>Source code in <code>mofun/atoms.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">save_mol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">file_comment</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Writes .mol file for structural information.&quot;&quot;&quot;</span>

    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot; Molecule_name: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">file_comment</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;  Coord_Info: Listed Cartesian None</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;        </span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">):</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%6d</span><span class="s2"> </span><span class="si">%10.4f</span><span class="s2"> </span><span class="si">%10.4f</span><span class="s2"> </span><span class="si">%10.4f</span><span class="s2">  </span><span class="si">%5s</span><span class="s2"> </span><span class="si">%10.8f</span><span class="s2">  0  0</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">charges</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;  Fundcell_Info: Listed</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;        </span><span class="si">%10.4f</span><span class="s2">       </span><span class="si">%10.4f</span><span class="s2">       </span><span class="si">%10.4f</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">)))</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;           90.0000          90.0000          90.0000</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;           0.00000          0.00000          0.00000</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;        </span><span class="si">%10.4f</span><span class="s2">       </span><span class="si">%10.4f</span><span class="s2">       </span><span class="si">%10.4f</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">)))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="mofun.atoms.Atoms.to_ase" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_ase</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Convert to ASE atoms object.</p>
<p>Only supports export of the positions and elements.</p>

        <details class="quote">
          <summary>Source code in <code>mofun/atoms.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_ase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert to ASE atoms object.</span>

<span class="sd">    Only supports export of the positions and elements.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">positions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cell&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell</span>
    <span class="k">return</span> <span class="n">ase</span><span class="o">.</span><span class="n">Atoms</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h2 id="mofun.atoms.find_unchanged_atom_pairs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_unchanged_atom_pairs</span><span class="p">(</span><span class="n">orig_structure</span><span class="p">,</span> <span class="n">final_structure</span><span class="p">,</span> <span class="n">max_delta</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">)</span></code>


</h2>

    <div class="doc doc-contents ">

      <p>Returns array of tuple pairs, where each pair contains the indices in the original and the final
structure that match.</p>
<p>Does not work across PBCs.</p>

        <details class="quote">
          <summary>Source code in <code>mofun/atoms.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">find_unchanged_atom_pairs</span><span class="p">(</span><span class="n">orig_structure</span><span class="p">,</span> <span class="n">final_structure</span><span class="p">,</span> <span class="n">max_delta</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns array of tuple pairs, where each pair contains the indices in the original and the final</span>
<span class="sd">    structure that match.</span>

<span class="sd">    Does not work across PBCs.&quot;&quot;&quot;</span>
    <span class="n">match_pairs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p1</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">orig_structure</span><span class="o">.</span><span class="n">positions</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">p2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">final_structure</span><span class="o">.</span><span class="n">positions</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">norm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span> <span class="o">-</span> <span class="n">p1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">max_delta</span> <span class="ow">and</span> <span class="n">orig_structure</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">final_structure</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
                <span class="n">match_pairs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">))</span>
                <span class="k">break</span>
    <span class="k">return</span> <span class="n">match_pairs</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../.." class="md-footer__link md-footer__link--prev" aria-label="Previous: MOFUN" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              MOFUN
            </div>
          </div>
        </a>
      
      
        
        <a href="../mofun/" class="md-footer__link md-footer__link--next" aria-label="Next: Mofun" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Mofun
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.94ec81fe.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.48dfec6c.min.js"></script>
      
    
  </body>
</html>